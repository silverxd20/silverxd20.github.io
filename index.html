<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Precio de productos Wow</title>
    <link rel="icon" href="https://findicons.com/files/icons/679/nx10/128/world_of_warcraft.png">

    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"></script>
</head>

<body>

    <!-- ************************** HTML MODAL *************************** -->

    <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
        aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div id="modalId" class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="ventanaTitulo"></h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">

                    <!-- Todo dentro de la ventanita -->
                    <div id="divForm" class="divForm">
                        <form action="">
                            <label id="PventaLabel" for="fname">Precio de venta:</label><br>
                            <input type="number" class="Pventa" id="PventaId" name="fname">
                            <b for="moneda" id="monedaId"></b>
                            <br><br>
                            <input id="btnCambiar" type="button" value="Cambiar">
                        </form>
                    </div>
                    <br>
                    <table id="tablaVerificacion" border="1">
                        <tr>
                            <th>Día</th>
                            <th>#</th>
                            <th>Precio alcanzado</th>
                            <th>Hora</th>
                        </tr>
                    </table>
                    <!-- FIN DE Todo dentro de la ventanita -->
                </div>
            </div>
        </div>
    </div>

    <!-- ************************* HTML PRINCIPAL *************************** -->

    <h1 id="titulo">Protuctos en subasta (Wow TBC)</h1>
    <input type="button" id="abrirCampoTextoBtn" value=">"></input>
    <div style="display: none;" id="divPassId">
        <input type="password" name="" id="campoPassID">
        <input type="button" id="btnGo" value="Go">
    </div>
    <select id="dropdownProductos">
    </select>

    <b id="idiomaLabel">Idioma:</b>
    <select onchange="SeleccionListaTraductor()" id="dropdownTraductor">
        <option value="Español">Español</option>
    </select>

    <p id="lastUpdated"></p>
    <button style="display:none" onclick="activarCors()" id="corsBtn">Activar Cors</button>
    <br></br>

    <table id="productos" border="1">
        <tr>
            <th>Imagen</th>
            <th>Nombre</th>
            <th>Precio Compra</th>
            <th>Compra hasta el 15%</th>
            <th>Precio de venta</th>
            <th>Ganancia Aproximada</th>
            <th id="porcentaje">%</th>
            <th>HeapMap</th>
            <th>Herramienta</th>
        </tr>
    </table>

    <style>
        body {
            background-color: #242424;
        }
        #titulo, #PventaLabel, #idiomaLabel, #ventanaTitulo, #lastUpdated, #monedaId{
            color: bisque;
        }
        #modalId {
            background-color: #242424;
        }

        table {
            border-collapse: collapse;
            width: 100%;
        }

        th,
        td {
            text-align: left;
            padding: 8px;
            color : burlywood
        }

        tr:nth-child(even) {
            background-color: rgb(51, 51, 51)
        }

        th {
            background-color: #091e4d;
            color: white;
            cursor: pointer;
        }
    </style>

    <script type="module">
        //firestore imports
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.9.2/firebase-app.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/9.9.2/firebase-firestore.js"
        import { collection, getDocs, addDoc, doc, setDoc } from "https://www.gstatic.com/firebasejs/9.9.2/firebase-firestore.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyB4a33fFr6SgUAXjZ6FeFB_XDGL6SKuCuY",
            authDomain: "wowprices-74a82.firebaseapp.com",
            projectId: "wowprices-74a82",
            storageBucket: "wowprices-74a82.appspot.com",
            messagingSenderId: "380944707410",
            appId: "1:380944707410:web:2f229f9fbf99d96e39148b"
        };

        const app = initializeApp(firebaseConfig);
        //variables para firestore
        var infoProductosArray = []

        //id elementos html
        var tablaProducto = document.getElementById('productos');
        var divId = document.getElementById("divPassId")
        var cuerpoTabla = document.createElement('tbody');
        var corsBoton = document.getElementById('corsBtn');
        var ventanaTituloId = document.getElementById("ventanaTitulo")
        var monedaNombreId = document.getElementById("monedaId")
        var selectProductos = document.createElement('dropdownProductos');
        var positivoNegativo = ""

        //eventos

        //cuando cambia el dropdown select producto
        document.getElementById('dropdownProductos').addEventListener('change', function () {
            SeleccionListaProducto()
        });

        //cuando haces click en el boton cambiar de la ventanita
        document.getElementById('btnCambiar').addEventListener('click', function () {
            cambiarPrecioVntaBtn()
        });

        //cuando haces click en el boton para mostrar el campo de texto
        document.getElementById('abrirCampoTextoBtn').addEventListener('click', function () {
            abrirOpciones()
        });

        //cuando haces click en el boton go para abrir el panel de agregar productos
        document.getElementById('btnGo').addEventListener('click', function () {
            btnGo()
        });

        //VARIABLES DEL LA VENTANITA
        var tablaVerificacion = document.getElementById('tablaVerificacion');
        var tbody = document.createElement('tbody');
        var campoTextPrecioVentaID = document.getElementById("PventaId")
        var campoTextoValor = document.getElementById("PventaId").value
        var precioVentaEnTablaNro = 0
        var tipoMonedaOroPlataBronce = ""
        var nombreUnico = ""
        var PrecioVenta = parseFloat(campoTextoValor) * 10000
        var diaSemana = ""
        var precioMinimo = ""
        var diaSemanaAnterior = "Sat"
        var cantidades = 0

        //obtiene el valor de ambos dropdown
        var dropdownProductosValor = document.getElementById("dropdownProductos").value
        var dropdownTraductorValor = document.getElementById("dropdownTraductor").value
        var urlNexusArray = []
        var NombreProductoArray = new Array()

        //Carga la hora del ultimo escarneo
        lastUpdated()

        //Inicia tratendo los datos y categorias del la base de datos
        leerDatos()

        tablaVerificacion.appendChild(tbody);
        tablaProducto.appendChild(cuerpoTabla);

        //LEE LOS DATOS DE FIREBASE
        async function leerDatos() {
            // Inicializa Firebase si no esta inicializado
            const app = initializeApp(firebaseConfig);

            const db = getFirestore(app);
            const colRef = collection(db, "data");
            const docsSnap = await getDocs(colRef);
            docsSnap.forEach(doc => {

                //agrega las categorias al dropdown
                for (const key in doc.data().tipo) {
                    const element = doc.data().tipo[key];
                    var daySelect = document.getElementById('dropdownProductos');
                    daySelect.options[daySelect.options.length] = new Option(element, element);
                }

                //guarda el json de los productos agregados
                for (const key in doc.data().infoProducts) {
                    var urlProductos = doc.data().infoProducts[key].url
                    var NombreEspañol = doc.data().infoProducts[key].traduccion
                    var categoria = doc.data().infoProducts[key].categoria
                    var expansion = doc.data().infoProducts[key].expansion
                    var nombreUnicoProduct = doc.data().infoProducts[key].nombreUnico

                    infoProductosArray.push(doc.data().infoProducts[key])
                    if("Pergaminos" == categoria){

                        traerProductoDatos(urlProductos, key, doc.data().infoProducts, dropdownTraductorValor, NombreEspañol, nombreUnicoProduct)
                    }
                }
            })
        }

        //Abre los URL de los productos trae sus datos en una tablas (Funcion principal)
        async function traerProductoDatos(urlProductos, indice, array, idioma, NombreEspañol, nombreUnicoProduct) {

            while (true) {
                try {
                    var corsurl = "https://cors-anywhere.herokuapp.com/"
                    //abre el url
                    const respuesta = await fetch(corsurl + urlProductos)
                    const json = await respuesta.json()
                    //Variable del producto
                    var productName = json.name
                    var uniqueName = json.uniqueName
                    var imagen = json.icon
                    var precioMinimo = json.stats.current.minBuyout / 10000
                    var precioMinimoRaw = json.stats.current.minBuyout / 10000
                    var precioPromedio = await json.stats.current.marketValue / 10000
                    var gananciaEstimada = gananciaPromedia(precioMinimo, precioPromedio).toFixed(4)
                    var porcentajeGanancia = gananciaEstimada / precioMinimoRaw * 100
                    var cantidades = await json.stats.current.quantity
                    //Verifica si el idioma es español
                    if (idioma == "Español") {
                        productName = NombreEspañol
                    }

                    //agrega los datos a a tabla
                    var fila = document.createElement('tr');

                    //la imagen del producto
                    var div_caption = document.createElement('div');
                    var img = document.createElement('img');
                    img.src = imagen;
                    fila.appendChild(div_caption);
                    fila.appendChild(img);

                    //crea el nombre
                    var td = document.createElement('td');
                    td.innerText = productName
                    td.setAttribute("style", "font-weight:bold");
                    fila.appendChild(td);

                    //crea el precio minimo
                    td = document.createElement('td');
                    td.setAttribute("style", "font-weight:bold");
                    td.innerText = PlataOro(precioMinimo);
                    fila.appendChild(td);

                    //crea el compra hasta el 15%
                    td = document.createElement('td');
                    var compraMaxima = CompraMaxima(precioPromedio, porcentajeGanancia)
                    if (compraMaxima == "-") {
                        td.innerText = compraMaxima;
                    } else {
                        td.innerText = PlataOro(compraMaxima);
                    }
                    td.setAttribute("style", "font-weight:bold");
                    fila.appendChild(td);

                    //crea el precio promedio
                    td = document.createElement('td');
                    td.innerText = PlataOro(precioPromedio);
                    td.setAttribute("style", "font-weight:bold");
                    fila.appendChild(td);

                    //crea la ganancia estimada
                    td = document.createElement('td');
                    td.innerText = PlataOro(gananciaEstimada);
                    //agrega color verde si es positivo y rojo si es negativo
                    if (positivoNegativo == true) {
                        td.setAttribute("style", "color:green");
                    } else {
                        td.setAttribute("style", "color:red");
                    }
                    fila.appendChild(td);

                    //crea el % de ganancia
                    td = document.createElement('tr');
                    td = document.createElement('td');
                    if (positivoNegativo == true) {
                        td.setAttribute("style", "color:green");
                    } else {
                        td.setAttribute("style", "color:red");
                    }
                    td.innerText = parseFloat(porcentajeGanancia).toFixed(2) + " %";
                    fila.appendChild(td);

                    //crea el boton para ver el heapmap
                    td = document.createElement('tr');
                    td = document.createElement("td");
                    var urlNexus = "https://nexushub.co/wow-classic/items/pagle-alliance/"
                    td.innerText = "Ver";
                    td.onclick = function (evt) {
                        window.open(
                            urlNexus + nombreUnicoProduct, "_blank");
                    }
                    fila.appendChild(td);

                    //crea el boton de la heramienta de venta
                    td = document.createElement('tr');
                    td = document.createElement("td");
                    NombreProductoArray.push(productName)
                    td.innerText = "Abrir";
                    td.setAttribute("data-bs-toggle", "modal")
                    td.setAttribute("data-bs-target", "#staticBackdrop")
                    td.onclick = function (evt) {
                        //agarra el texto de la tabla y lo coloca en la ventana segun el producto
                        campoTextPrecioVentaID = document.getElementById("PventaId")
                        //pone el nombre del producto en el titulo de la ventanita
                        var NombreProductoClickeado = evt.path[1].childNodes[2].innerHTML
                        ventanaTituloId.innerText = NombreProductoClickeado

                        //obtiene el valor del precio de venta sugerido en la tabla
                        var precioVentaEnTablaTexto = evt.path[1].childNodes[5].innerHTML
                        precioVentaEnTablaNro = evt.path[1].childNodes[5].innerHTML.split(" ")[0]
                        tipoMonedaOroPlataBronce = evt.path[1].childNodes[5].innerHTML.split(" ")[1]

                        //pone el precio obtenido de la tabla "precio venta" en el campo de texto
                        campoTextPrecioVentaID.value = precioVentaEnTablaNro

                        //Pone al lado de campo de texto el tipo de moneda
                        monedaNombreId.innerText = tipoMonedaOroPlataBronce

                        //Nombre del producto con guion ejemp: scroll-of-agility-iv
                        nombreUnico = nombreUnicoProduct

                        //inicia la consulta
                        SolicitarDatos(precioVentaEnTablaNro, tipoMonedaOroPlataBronce, nombreUnico)

                    }
                    fila.appendChild(td);

                    cuerpoTabla.appendChild(fila);
                    break
                } catch (error) {
                    //captura el error cuando pide cors y hace visible el boton
                    if (SyntaxError) {
                        console.log(SyntaxError)
                        console.log("Es el error del cors")
                        corsBoton.style.display = "inherit"
                    } else if (TypeError) {
                        "Salio el fail to fetch"
                    }
                    sleep(2000)
                }
            }
        }

        //abre el panel
        function abrirOpciones() {
            divId.setAttribute("style", "display: visible")
        }

        //el boton Go
        function btnGo() {
            var campiIdPass = document.getElementById("campoPassID")

            if (campiIdPass.value == aja) {
                window.open("dashboard/panel.html", "_blank");
                campiIdPass.value = ""
                divId.setAttribute("style", "display: none")
            }
        }

        //pone los numero en 0 como plata si no lo deja en oro
        function PlataOro(nro) {

            var PrecioFloat = nro
            if (PrecioFloat > 1) {
                //si es positivo y es oro
                var precioMinimo = parseFloat(PrecioFloat).toFixed(2) + " Oro"
                positivoNegativo = true

            } else if (PrecioFloat > 0.01) {
                //si es positivo y es plata
                var precioMinimo = parseFloat(PrecioFloat).toFixed(4) * 100 + " Plata"
                if (precioMinimo == 1) {
                    precioMinimo = PrecioFloat + " Oro"
                }
                positivoNegativo = true

            } else if (PrecioFloat > 0.001) {
                //si es positivo y es cobre
                var precioMinimo = PrecioFloat * 10000 + " Cobre"
                positivoNegativo = true
            } else {
                //aqui esto es negativo
                precioMinimo = PrecioFloat * 100
                positivoNegativo = false

                if (precioMinimo < -100) {
                    //si esto es negativo y pasa de -100
                    var precioMinimo = parseFloat(precioMinimo / 100).toFixed(2) + " Oro"

                } else {
                    //si esto es negativo y es menor a -100
                    var precioMinimo = PrecioFloat * 100 + " Plata"
                }
            }
            return precioMinimo;
        }

        //Dice la ganancia si se publica al precio promedio
        function gananciaPromedia(preMinimo, prePromedio) {
            var calculoDelCincoPorcieto = prePromedio * 5 / 100
            var SaldoMenosCincoPorciento = prePromedio - calculoDelCincoPorcieto
            var gananciaEstimada = SaldoMenosCincoPorciento - preMinimo
            return gananciaEstimada;
        }

        //Seleccion del dropdown de productos
        function SeleccionListaProducto(event) {
            var dropdownProductosValue = document.getElementById("dropdownProductos").value
            var dropdownTraductorValue = document.getElementById("dropdownTraductor").value

            //Carga la hora del ultimo escarneo
            lastUpdated()
            LimpiarTabla()
            for (const key in infoProductosArray) {

                if (dropdownProductosValue == infoProductosArray[key].categoria) {
                    var urlProductos = infoProductosArray[key].url
                    var NombreEspañol = infoProductosArray[key].traduccion
                    var categoria = infoProductosArray[key].categoria
                    var expansion = infoProductosArray[key].expansion
                    var nombreUnicoProducto = infoProductosArray[key].nombreUnico
                    traerProductoDatos(urlProductos, key, infoProductosArray, dropdownTraductorValue, NombreEspañol, nombreUnicoProducto)
                }
            }
        }

        //selecion del dropdown traductor español ingles
        function SeleccionListaTraductor() {
            //obtiene el valor de ambos dropdown
            dropdownProductosValor = document.getElementById("dropdownProductos").value
            dropdownTraductorValor = document.getElementById("dropdownTraductor").value

            //Carga la hora del ultimo escarneo y se limpia la tabla
            lastUpdated()
            LimpiarTabla()

            //Se verifica cual producto esta seleccionado también
            if (dropdownProductosValor == "Plantas de classic") {
                urlPlantasVanilla.forEach(function (links, index, array) {
                    traerProductoDatos(links, index, array, dropdownTraductorValor)
                });

            } else if (dropdownProductosValor == "Plantas de TBC") {
                urlPlantasTBC.forEach(function (links, index, array) {
                    traerProductoDatos(links, index, array, dropdownTraductorValor)
                });
            } else if (dropdownProductosValor == "Pergaminos") {
                urlPergaminos.forEach(function (links, index, array) {
                    traerProductoDatos(links, index, array, dropdownTraductorValor)
                });
            } else if (dropdownProductosValor == "Menas") {
                urlMenas.forEach(function (links, index, array) {
                    traerProductoDatos(links, index, array, dropdownTraductorValor)
                });
            }
        }

        //Limpia la tabla
        function LimpiarTabla() {
            var tableHeaderRowCount = 1;
            var table = document.getElementById('productos');
            var rowCount = table.rows.length;
            for (var i = tableHeaderRowCount; i < rowCount; i++) {
                table.deleteRow(tableHeaderRowCount);
            }
        }

        //Fecha de la ultima actualización
        function lastUpdated() {
            while (true) {
                try {
                    var corsurl = "https://cors-anywhere.herokuapp.com/"
                    var resultDate = fetch(corsurl + "https://api.nexushub.co/wow-classic/v1/items/pagle-alliance/scroll-of-agility-iv")
                        .then(resultDate => resultDate.json())
                        .then(function (fecha) {
                            const d = new Date(fecha.stats.lastUpdated);
                            var hora = hora24a12(d.getHours())
                            var minuto = d.getMinutes()
                            document.getElementById("lastUpdated").innerHTML = "Último escaneo: " + hora[0] + ":" + minuto + " " + hora[1];
                            console.log("Último escaneo: " + hora[0] + ":" + minuto + " " + hora[1])
                        })
                    break
                } catch (error) {
                    console.log(error)
                    sleep(2000)
                }
            }
        }

        //sugiere comprar hasta el 15% si la ganancia es mayor al 20%
        function CompraMaxima(prePromedio, porcentajeGanancia) {

            var porcentajeEsperado = 20
            if (porcentajeGanancia >= porcentajeEsperado) {

                var calculoDelCincoPorcieto1 = prePromedio * 5 / 100
                var SaldoPromedioMenosCincoPorciento = prePromedio - calculoDelCincoPorcieto1
                //
                var saldoCompraHasta15 = SaldoPromedioMenosCincoPorciento * 0.85
            } else {
                var saldoCompraHasta15 = "-"
            }

            return saldoCompraHasta15

        }

        //sleep
        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        //Cambia el horario 24 horas a 12 horas.
        function hora24a12(hora) {
            if (hora == 12) {
                hora = [12, "pm"]
            } else if (hora == 13) {
                hora = [1, "pm"]
            } else if (hora == 14) {
                hora = [2, "pm"]
            } else if (hora == 15) {
                hora = [3, "pm"]
            } else if (hora == 16) {
                hora = [4, "pm"]
            } else if (hora == 17) {
                hora = [5, "pm"]
            } else if (hora == 18) {
                hora = [6, "pm"]
            } else if (hora == 19) {
                hora = [7, "pm"]
            } else if (hora == 20) {
                hora = [8, "pm"]
            } else if (hora == 21) {
                hora = [9, "pm"]
            } else if (hora == 22) {
                hora = [10, "pm"]
            } else if (hora == 23) {
                hora = [11, "pm"]
            } else if (hora == 24) {
                hora = [12, "am"]
            } else if (hora == 0) {
                hora = [12, "am"]
            } else {
                hora = [hora, "am"]
            }
            return hora;
        }

        //click al boton para activar cors
        function activarCors() {
            urlCors = "https://cors-anywhere.herokuapp.com/corsdemo"
            window.open(urlCors, "_blank");
        }

        //ordena la tabla de mayor a menor
        function compareValues(a, b) {
            // return -1/0/1 based on what you "know" a and b
            // are here. Numbers, text, some custom case-insensitive
            // and natural number ordering, etc. That's up to you.
            // A typical "do whatever JS would do" is:
            return (a > b) ? -1 : (a < b) ? 1 : 0;
        }

        function sortTable(colnum) {
            var tbody = tablaProducto.querySelector(`tbody`);
            var rows = Array.from(tablaProducto.querySelectorAll(`tr`));
            // but ignore the heading row:
            rows = rows.slice(1);
            var posicion = colnum + 2
            // set up the queryselector for getting the indicated
            // column from a row, so we can compare using its value:
            var qs = `td:nth-child(${posicion})`;

            // and then just... sort the rows:
            rows.sort((r1, r2) => {
                // get each row's relevant column
                var t1 = r1.querySelector(qs);
                var t2 = r2.querySelector(qs);
                // and then effect sorting by comparing their content:
                return compareValues(t1.textContent, t2.textContent);
            });

            // and then the magic part that makes the sorting appear on-page:
            rows.forEach(row => tbody.appendChild(row));
        }
        tablaProducto.querySelectorAll(`th`).forEach((th, position) => {
            th.addEventListener(`click`, evt => sortTable(position));
        });


        //******************************* JS DE LA VENTANA **********************************

        //funcion que solicita los datos del url
        async function SolicitarDatos(precioVentaEnTablaNro, tipoMonedaOroPlataBronce, uniqueName) {

            if (tipoMonedaOroPlataBronce == "Oro") {
                precioVentaEnTablaNro = precioVentaEnTablaNro * 10000
                console.log("Es oro: " + precioVentaEnTablaNro)
            } else if (tipoMonedaOroPlataBronce == "Plata") {
                precioVentaEnTablaNro = precioVentaEnTablaNro * 100
                console.log("Es plata: " + precioVentaEnTablaNro)

            } else if (tipoMonedaOroPlataBronce == "Cobre") {
                precioVentaEnTablaNro = precioVentaEnTablaNro * 10
                console.log("Es plata: " + precioVentaEnTablaNro)
            }

            LimpiarTablaVerificacion()
            var corsurl = "https://cors-anywhere.herokuapp.com/"
            var Url = "https://api.nexushub.co/wow-classic/v1/items/pagle-alliance/" + uniqueName + "/prices"

            const respuesta = await fetch(corsurl + Url)
            const jsonResultado = await respuesta.json()
            for (var index = 0; index < jsonResultado.data.length; index++) {

                const d = new Date(jsonResultado.data[index].scannedAt);
                var hora = hora24a12(d.getHours())
                var minuto = d.getMinutes()
                var horaMinutos = hora[0] + ":" + minuto + " " + hora[1]
                var diaSemana = d.toString().split(" ")[0]
                var precioCompra = jsonResultado.data[index].minBuyout

                if (precioCompra > precioVentaEnTablaNro) {
                    //verifica si el dia de la semana es el mismo o ha cambiado
                    if (diaSemana == diaSemanaAnterior) {
                        //en caso que sea el mismo dia
                        cantidades = cantidades + 1
                        diaSemanaAnterior = diaSemana
                        precioCompra = PlataOro(precioCompra / 10000)
                        crearColumna(diaSemana, cantidades, precioCompra, horaMinutos)

                    } else {
                        //cuando cambia a otro dia de la semana
                        cantidades = 1
                        diaSemanaAnterior = diaSemana
                        precioCompra = PlataOro(precioCompra / 10000)
                        crearColumna(diaSemana, cantidades, precioCompra, horaMinutos)
                    }
                }
            }

        }

        //agrega los datos de la tabla a la ventana
        function agregaDatosDeTablaAVentana(evt) {

        }

        //funcion que crea las columnas de la tabla
        function crearColumna(diaSemana, cantidades, precioCompra, Hora) {

            //crea un TR
            var fila = document.createElement('tr');

            //agrega la columna Día
            var td = document.createElement('td');
            td.innerText = TraducirDiaSemana(diaSemana)
            td.setAttribute("style", "font-weight:bold");
            fila.appendChild(td);

            //agrega la columna #
            td = document.createElement('td');
            td.innerText = cantidades
            td.setAttribute("style", "font-weight:bold");
            fila.appendChild(td);
            tbody.appendChild(fila);

            //agrega la columna Precio Compra
            td = document.createElement('td');
            td.innerText = precioCompra
            td.setAttribute("style", "font-weight:bold");
            fila.appendChild(td);
            tbody.appendChild(fila);

            //agrega la columna Hora
            td = document.createElement('td');
            td.innerText = Hora
            td.setAttribute("style", "font-weight:bold");
            fila.appendChild(td);
            tbody.appendChild(fila);
        }

        //el Boton para hacer una nueva verificacion con otro precio de venta
        function cambiarPrecioVntaBtn() {
            campoTextPrecioVentaID = document.getElementById("PventaId")
            campoTextPrecioVentaID = campoTextPrecioVentaID.value
            SolicitarDatos(campoTextPrecioVentaID, tipoMonedaOroPlataBronce, nombreUnico)
        }

        //Limpia la tabla
        function LimpiarTablaVerificacion() {
            var tableHeaderRowCount = 1;
            var table = document.getElementById('tablaVerificacion');
            var rowCount = table.rows.length;
            for (var i = tableHeaderRowCount; i < rowCount; i++) {
                table.deleteRow(tableHeaderRowCount);
            }
        }

        //traduccion de dia de la semana
        function TraducirDiaSemana(diaSemana) {
            if (diaSemana == "Mon") {
                diaSemana = "Lunes"
            } else if (diaSemana == "Tue") {
                diaSemana = "Martes"
            } else if (diaSemana == "Wed") {
                diaSemana = "Miercoles"
            } else if (diaSemana == "Thu") {
                diaSemana = "Jueves"
            } else if (diaSemana == "Fri") {
                diaSemana = "Viernes"
            } else if (diaSemana == "Sat") {
                diaSemana = "Sabado"
            } else if (diaSemana == "Sun") {
                diaSemana = "Domingo"
            }

            return diaSemana;
        }

        var aja = "abrete"

    </script>

</body>

</html>